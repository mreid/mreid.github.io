<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>

   <!-- Standard site meta information -->
   <meta http-equiv="content-type" content="text/html; charset=utf-8" />
   <title>Behold! Jensen's Inequality ← Inductio Ex Machina ← Mark Reid</title>
   <meta name="author" content="Mark Reid" />

   <link rel="openid.server" href="http://www.myopenid.com/server" />
   <link rel="openid.delegate" href="http://mark.reid.name" />

   <link rel="start" href="../" />

   <!-- syntax highlighting CSS -->
   <link rel="stylesheet" href="../css/syntax.css" type="text/css" />

   <!-- Homepage CSS -->
   <link rel="stylesheet" href="../css/screen.css" type="text/css" media="all" />
   <link rel="stylesheet" href="../css/print.css" type="text/css" media="print" />
   <link rel="stylesheet" href="../css/widgets.css" type="text/css" media="all" />
   <link rel="stylesheet" href="../css/amjr.css" type="text/css" media="all" />

 	<meta name="twitter:card" content="summary">
    <meta name="twitter:creator" content="@mdreid">
    <meta name="twitter:site" content="@mdreid">
    <meta name="twitter:title" content="Behold! Jensen's Inequality">
    <meta name="twitter:description" content="Unsatisfied with the very algebraic and formal proofs of Jensen's inequality, I present a diagram that gives a graphical intuition for the result.">

<!-- MathJax configuration and loading -->
<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
		extensions: ["tex2jax.js"],
		jax: ["input/TeX", "output/HTML-CSS"],
		tex2jax: {
			inlineMath: [ ["\\(","\\)"] ],
			displayMath: [ ["\\[","\\]"] ],
			processEscapes: true
		},
		TeX: { equationNumbers: { autoNumber: "AMS" } },
		"HTML-CSS": { availableFonts: ["TeX"] }
	});
</script>
<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"}> </script>

</head>

<body id="Blog">

<div id="site">
  <div id="header">
<h1>
	<a href="../blog/" title="A machine learning blog">Inductio ex Machina</a>
	<span class="byline">← <a href="../">Mark Reid</a></span>
</h1>
<ul class="nav">
  <li><a class="home" href="../blog/">Home</a></li>
  <li><a class="info" href="../blog/info.html">Info</a></li>
  <li><a class="past" href="../blog/past.html">Past</a></li>
  <li><a class="kith" href="../blog/kith.html">Kith</a></li>
</ul>
</div>

<div id="page">

<h1 class="emphnext">Behold! Jensen's Inequality</h1>

<p>I have been making quite some use of Jensen’s inequality recently. It states that the expected value of a convex transformation of a random variable is at least the value of the convex function at the mean of the random variable. More formally, if ƒ is a real-valued convex function over some finite dimensional convex set <span class="math">\(X\)</span> and <span class="math">\(x\)</span> is an <span class="math">\(X\)</span>-valued random variable then we can define the <em>Jensen gap</em> <span class="math">\[
J_f(x) := \mathbb{E}\left[ f\left(x\right) \right] - f\left(\mathbb{E}\left[ x \right]\right)
\]</span> where <span class="math">\(\mathbb{E}\)</span> denotes expectation. Jensen’s inequality states that this gap is never negative, that is, <span class="math">\(J_f(x) \geq 0\)</span> or equivalently, <span class="math">\[
\mathbb{E}\left[ f\left(x\right) \right] \geq f\left(\mathbb{E}\left[ x \right]\right).
\]</span></p>
<p>This is a fairly simple but important inequality in the study of convex functions. Through judicious choice of the convex function it can be used to derive a <a href="http://en.wikipedia.org/wiki/Inequality_of_arithmetic_and_geometric_means#Proof_of_the_generalized_AM-GM_inequality_using_Jensen.27s_inequality">general AM-GM inequality</a> and many results in information theory. I’ve been interested in it because DeGroot’s notion of <a href="http://projecteuclid.org/euclid.aoms/1177704567">statistical information</a> and measures of the distance between probability distributions called <a href="http://en.wikipedia.org/wiki/F-divergence">f-divergences</a> can both be expressed as a Jensen gap and consequently related to each other.</p>
<p>Jensen’s inequality is not difficult to prove. It is almost a direct consequence of the definition of convexity and the linearity of expectation. However, all of the proofs I’ve read, including those in books by <a href="http://books.google.com/books?id=wj4Fh4h_V7QC">Rockafellar</a> and by <a href="http://books.google.com/books?id=Wv_zxEExK3QC">Dudley</a> feel like they are from the <a href="http://en.wikipedia.org/wiki/Nicolas_Bourbaki">Bourbaki</a> school in that they present the proof without recourse to any diagrams.</p>
<p>I was quite happy then to have found a graphical “proof” of Jensen’s inequality. By this I mean a proof in the style of the <a href="http://www.math.ntnu.no/~hanche/pythagoras/">proof of Pythagoras’ theorem</a> that is simply a diagram with the word “Behold!” above it.</p>
<dl class="figure">
<dt>
	
<img src="../pics/figures/jensen.png" alt="Jensen\'s Inequality" title="Jensen\'s Inequality" />
</dt><dd>
	<p>
<em>Figure 1</em>: Behold! A graphical demonstration of Jensen’s Inequality. The expectations shown are with respect to an arbitrary discrete distribution over the <span class="math">\(x_i\)</span>
</p>
</dd>
</dl>

<p>Unfortunately, the diagram in Figure 1 is not quite as transparent as the Pythagorean proof so a little discussion is probably required. The diagram shows an instance of Jensen’s inequality for a discrete distribution where the random variable <span class="math">\(x\)</span> takes on one of the <span class="math">\(n\)</span> values <span class="math">\(x_i\)</span> with with probability <span class="math">\(p_i\)</span>.</p>
<p>Note that the points <span class="math">\((x_i, f(x_i))\)</span> form the vertices of a polygon which, by the convexity of ƒ, must also be convex and lie within the epigraph of ƒ (the blue shaded area above ƒ). Furthermore, since the <span class="math">\(p_i\)</span> are probabilities they satisfy <span class="math">\(\sum_i p_i = 1\)</span>. This means the expected value of the random variable <span class="math">\((x, f(x))\)</span> given by <span class="math">\[
   \mathbb{E}[(x, f(x))] = \sum_{i=1}^n p_i \left(x_i, f(x_i)\right) 
\]</span> is a convex combination and so must also lie within the dashed polygon. In fact, since <span class="math">\(\mathbb{E}[(x, f(x))] = \left(\mathbb{E}[x], \mathbb{E}[f(x)]\right)\)</span> it must lie above <span class="math">\(f\left(\mathbb{E}[x]\right)\)</span> thus giving the result.</p>
<p>Although the diagram in Figure 1 assumes a 1-dimensional space <span class="math">\(X\)</span> the above argument generalises to higher dimensions in an analogous manner. Also, the general result for non-discrete distributions can be gleamed from the provided diagram by a hand-wavy limiting argument. By adding more <span class="math">\(x_i\)</span> to the diagram the dashed polygon the shaded area will approximate the graph of ƒ better. So, by the earlier argument for the discrete case, the expected value of <span class="math">\(x\)</span> will remain within the polygon and thus within the shaded area and thus above ƒ. Since this holds for an arbitrary number of points and nothing weird happens as we take the limit we have the continuous result.</p>
<p>A somewhat surprising fact about Jensen’s inequality is that its converse is also true. By this I mean that if ƒ is a function such that its Jensen gap <span class="math">\(J_f(x)\)</span> is non-negative for all distributions of the random variable <span class="math">\(x\)</span> then ƒ is necessarily convex. The contrapositive of this statement is: ƒ non-convex implies the existence of a random variable <span class="math">\(x\)</span> so that <span class="math">\(J_f(x) &lt; 0\)</span>.</p>
<p>Considering Figure 1 again gives some intuition as to why this must be the case. If ƒ was non-convex then its epigraph must, by definition, also be non-convex. This means I could choose some <span class="math">\(x_i\)</span> so that one of the dashed lines lies outside the shaded area. This means I can then choose <span class="math">\(p_i\)</span> so that the mean <span class="math">\(\mathbb{E}[(x, f(x))]\)</span> lies outside the shaded area and thus below the graph of ƒ.</p>
<p>Of course, no self-respecting mathematician would call the above arguments a proof of Jensen’s inequality. There are too many edge cases and subtleties (especially in the continuous case) that I’ve ignored. That said, I believe the statement and thrust of the inequality can be quickly arrived at from the simple diagram above. When using tools like Jensen’s inequality, I find this type of quick insight more valuable than a long, careful technical statement and proof. The latter is valuable to but if I need this level of detail I would look it up rather than try to dredge it up from my sometimes unreliable memory.</p>


<address class="signature">
	<a class="author" href="http://mark.reid.name">Mark Reid</a>
  <span class="date">November 17, 2008</span>
  <span class="location">Canberra, Australia</span>
</address>

</div>
<address id="feed" class="quiet right">Subscribe: <a href="../blog/atom.xml" title="Subscribe to Atom feed"><em>Atom Feed</em></a></address>


<!-- Disqus Comments -->
<div id="disqus_thread"></div>

<!-- Enable Disqus comments -->
<script type="text/javascript">
        var disqus_iframe_css = "http://mark.reid.name/css/screen.css";
        var disqus_title = "Behold! Jensen's Inequality";
        var disqus_message = "Unsatisfied with the very algebraic and formal proofs of Jensen's inequality, I present a diagram that gives a graphical intuition for the result.";
</script>
<script type="text/javascript" src="http://disqus.com/forums/markreid/embed.js"></script>

<noscript>
    <a href="http://markreid.disqus.com/?url=ref">View the discussion thread.</a>
</noscript>




    <!-- Footer with copyright and contact information -->
  <div id="footer">
	<address>
		<span class="copyright">
			Content &amp; Design by 
			<a href="../info/site.html">Mark Reid</a>
			<br />
			(<a rel="licence" href="http://creativecommons.org/licenses/by-nc-sa/3.0/">Some rights reserved</a>)			
		</span>
		<span class="engine">
			Powered by 
			<a href="http://jaspervdj.be/hakyll/" title="A static, minimalist, Haskell-powered CMS">Hakyll</a>
		</span>
	</address>
  </div>

</div>


<!-- Google Analytics script -->
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-1051817-4");
pageTracker._trackPageview();
</script>
<!--[if IE 6]>
<script type="text/javascript"> 
	/*Load jQuery if not already loaded*/ if(typeof jQuery == 'undefined'){ document.write("<script type=\"text/javascript\"   src=\"http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js\"></"+"script>"); var __noconflict = true; } 
	var IE6UPDATE_OPTIONS = {
		icons_path: "http://static.ie6update.com/hosted/ie6update/images/"
	}
</script>
<script type="text/javascript" src="http://static.ie6update.com/hosted/ie6update/ie6update.js"></script>
<![endif]-->


</body>
</html>



