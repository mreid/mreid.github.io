<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>

   <!-- Standard site meta information -->
   <meta http-equiv="content-type" content="text/html; charset=utf-8" />
   <title>Warning! High Dimensions Ahead ← Inductio Ex Machina ← Mark Reid</title>
   <meta name="author" content="Mark Reid" />

   <link rel="openid.server" href="http://www.myopenid.com/server" />
   <link rel="openid.delegate" href="http://mark.reid.name" />

   <link rel="start" href="../" />

   <!-- syntax highlighting CSS -->
   <link rel="stylesheet" href="../css/syntax.css" type="text/css" />

   <!-- Homepage CSS -->
   <link rel="stylesheet" href="../css/screen.css" type="text/css" media="all" />
   <link rel="stylesheet" href="../css/print.css" type="text/css" media="print" />
   <link rel="stylesheet" href="../css/widgets.css" type="text/css" media="all" />
   <link rel="stylesheet" href="../css/amjr.css" type="text/css" media="all" />

 	<meta name="twitter:card" content="summary">
    <meta name="twitter:creator" content="@mdreid">
    <meta name="twitter:site" content="@mdreid">
    <meta name="twitter:title" content="Warning! High Dimensions Ahead">
    <meta name="twitter:description" content="A very counter-intuitive result that highlights the danger of reasoning about higher dimensional space by analogy with lower dimensional ones.">

<!-- MathJax configuration and loading -->
<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
		extensions: ["tex2jax.js"],
		jax: ["input/TeX", "output/HTML-CSS"],
		tex2jax: {
			inlineMath: [ ["\\(","\\)"] ],
			displayMath: [ ["\\[","\\]"] ],
			processEscapes: true
		},
		TeX: { equationNumbers: { autoNumber: "AMS" } },
		"HTML-CSS": { availableFonts: ["TeX"] }
	});
</script>
<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"}> </script>

</head>

<body id="Blog">

<div id="site">
  <div id="header">
<h1>
	<a href="../blog/" title="A machine learning blog">Inductio ex Machina</a>
	<span class="byline">← <a href="../">Mark Reid</a></span>
</h1>
<ul class="nav">
  <li><a class="home" href="../blog/">Home</a></li>
  <li><a class="info" href="../blog/info.html">Info</a></li>
  <li><a class="past" href="../blog/past.html">Past</a></li>
  <li><a class="kith" href="../blog/kith.html">Kith</a></li>
</ul>
</div>

<div id="page">

<h1 class="emphnext">Warning! High Dimensions Ahead</h1>

<p>Machine learning is often framed as finding surfaces (usually <a href="http://hunch.net/?p=524">planes</a>) that separate or fit points in some high dimensional space. Two and three dimensional diagrams are often used as an aid to intuition when thinking about these higher dimensional spaces. The following result (related to me by <a href="http://www.hutter1.net/">Marcus Hutter</a>) shows that our low dimensional intuition can easily lead us astray.</p>
<p>Consider the diagram in Figure 1. The larger grey spheres have radius 1 and are each touching exactly two other grey spheres. The blue circle is then placed so that it touches all four grey circles.</p>
<p>Pythagoras tells us that <span class="math">\(1^2 + 1^2 = (1+r)^2\)</span> and so <span class="math">\(r = \sqrt{2} - 1 \approx 0.41\)</span>. Clearly then, the blue circle lies entirely within the square of width 4 containing all the grey spheres.</p>
<dl class="figure">
<dt>
<img src="../pics/figures/high-dim-2d.png" alt="2-dimensional packing" />
</dt>
<dd><p>
<em>Figure 1</em>: The blue circle in the middle touches each of the four identical grey circles.
</p></dd>
</dl>

<p>We can move to three dimensions and set up an analogue of the two dimensional situation by arranging eight spheres of radius 1 so they are touching exactly three other grey spheres.</p>
<p>As in the case with circles, we can place a blue sphere inside the eight grey spheres so that it touches all of them. In this case, the radius of the blue sphere can be found by solving <span class="math">\(1^2 + 1^2 + 1^2 = (1+r)^2\)</span> and so <span class="math">\(r = \sqrt{3} -1 \approx 0.73\)</span>, thus it is still inside the cube of width 4 that holds all eight grey spheres.</p>
<dl class="figure">
<dt>
<img src="../pics/figures/high-dim-3d.png" alt="3-dimensional packing" />
</dt>
<dd><p>
<em>Figure 2:</em> The blue sphere touches each of the eight identical grey spheres.
</p></dd>
</dl>

<p>It’s not too hard to convince yourself that we can carry on this construction through to higher dimensions.</p>
<p>In four dimensional space we would arrange 16 grey hyperspheres of radius 1 so that each is touching exactly four others. In this case, <span class="math">\(r = \sqrt{4} - 1 = 1\)</span> and the blue hypersphere is the same size as the grey ones. Going up again to five dimensional space, we would have 32 hyperspheres, each touching five others. Following the pattern, in this case <span class="math">\(r = \sqrt{5} - 1 \approx 1.23\)</span>. and the blue sphere is larger than the grey spheres in this case but still within the hypercube of width 4 that contains all 32 grey hyperspheres.</p>
<p>The pattern should now be apparent. In n-dimensional space there will be <span class="math">\(2^n\)</span> grey hyperspheres of radius 1 that touch <span class="math">\(n\)</span> other hyperspheres and the radius of the blue sphere that touches all of them will be <span class="math">\[
	r = \sqrt{n} - 1.
\]</span></p>
<p>At this point Dorothy turns to her canine companion and says, “We are not in three dimensional Kansas anymore, Toto.”</p>
<p>The blue sphere that sits in the centre of all the grey ones will have a radius that increases without bound. A particularly curious thing happens when we construct the 9-dimensional case. The radius of the blue hypersphere is <span class="math">\(\sqrt{9} - 1 = 2\)</span> and so touches the faces of the hypercube that contains all the grey hyperspheres.</p>
<p>Stranger still, once we are in 10 dimensional space or higher, parts of the blue hypersphere will <em>hang outside</em> the box holding all the grey ones.</p>
<p>Thinking about the relative volume of the containing box and the grey spheres gives us some insight into what is happening. In <span class="math">\(n\)</span> dimensions the volume of the containing box is <span class="math">\(4^n\)</span> while the <a href="http://en.wikipedia.org/wiki/N-sphere#n-ball">volume of a <span class="math">\(n\)</span>-ball with radius 1</a> is <span class="math">\[
	\frac{\pi^{\frac{n}{2}}}{\Gamma(\frac{n}{2}+1)} 
	= \begin{cases}
		\displaystyle \pi^k / k! ,&amp; n=2k \\
		\displaystyle 2^{2k+1}k!\pi^k / (2k+1)! ,&amp; n=2k+1
	\end{cases}
\]</span> where <span class="math">\(\Gamma\)</span> is the <a href="http://en.wikipedia.org/wiki/Gamma_function">generalised factorial function</a>.</p>
<p>For simplicity let us only consider the even dimensional cases where <span class="math">\(n=2k\)</span>. Here, the total volume of the <span class="math">\(2^n\)</span> grey hyperspheres is <span class="math">\(2^{2k} \pi^k / k!\)</span> and so the proportion of the box occupied by the grey hyperspheres is <span class="math">\[
	\frac{2^{2k}\pi^k}{4^k k!} = \left(\frac{\pi}{4}\right)^k / k!
\]</span> Since factorials are faster growing than exponentials the total proportion of volume occupied by the grey sphere in the box goes to zero as the dimension increases. In effect, the grey hyperspheres are “disappearing” relative to the containing box, leaving more room for the blue sphere to fill.</p>
<p>The moral of this story should be familiar to anyone in machine learning: generalising from a handful of examples is a bad idea. What seems obvious in two and three dimensional space does not hold in 10 dimensions or higher.</p>


<address class="signature">
	<a class="author" href="http://mark.reid.name">Mark Reid</a>
  <span class="date">January 25, 2009</span>
  <span class="location">Canberra, Australia</span>
</address>

</div>
<address id="feed" class="quiet right">Subscribe: <a href="../blog/atom.xml" title="Subscribe to Atom feed"><em>Atom Feed</em></a></address>


<!-- Disqus Comments -->
<div id="disqus_thread"></div>

<!-- Enable Disqus comments -->
<script type="text/javascript">
        var disqus_iframe_css = "http://mark.reid.name/css/screen.css";
        var disqus_title = "Warning! High Dimensions Ahead";
        var disqus_message = "A very counter-intuitive result that highlights the danger of reasoning about higher dimensional space by analogy with lower dimensional ones.";
</script>
<script type="text/javascript" src="http://disqus.com/forums/markreid/embed.js"></script>

<noscript>
    <a href="http://markreid.disqus.com/?url=ref">View the discussion thread.</a>
</noscript>




    <!-- Footer with copyright and contact information -->
  <div id="footer">
	<address>
		<span class="copyright">
			Content &amp; Design by 
			<a href="../info/site.html">Mark Reid</a>
			<br />
			(<a rel="licence" href="http://creativecommons.org/licenses/by-nc-sa/3.0/">Some rights reserved</a>)			
		</span>
		<span class="engine">
			Powered by 
			<a href="http://jaspervdj.be/hakyll/" title="A static, minimalist, Haskell-powered CMS">Hakyll</a>
		</span>
	</address>
  </div>

</div>


<!-- Google Analytics script -->
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-1051817-4");
pageTracker._trackPageview();
</script>
<!--[if IE 6]>
<script type="text/javascript"> 
	/*Load jQuery if not already loaded*/ if(typeof jQuery == 'undefined'){ document.write("<script type=\"text/javascript\"   src=\"http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js\"></"+"script>"); var __noconflict = true; } 
	var IE6UPDATE_OPTIONS = {
		icons_path: "http://static.ie6update.com/hosted/ie6update/images/"
	}
</script>
<script type="text/javascript" src="http://static.ie6update.com/hosted/ie6update/ie6update.js"></script>
<![endif]-->


</body>
</html>



